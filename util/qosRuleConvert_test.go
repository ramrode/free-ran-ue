package util_test

import (
	"testing"

	"github.com/free-ran-ue/free-ran-ue/v2/util"
	"github.com/go-playground/assert"
)

var testQosRuleCases = []struct {
	name      string
	ruleBytes []byte
	expected  []string
}{
	{
		name: "two rules",
		ruleBytes: []byte{
			0x01, 0x00, 0x06, 0x31, 0x31, 0x01, 0x01, 0xff, 0x01,
			0x02, 0x00, 0x06, 0x21, 0x31, 0x01, 0x01, 0xff, 0x00,
			0x03, 0x00, 0x0e, 0x21, 0x12, 0x09, 0x10, 0x0a, 0x01, 0x00, 0x03, 0xff, 0xff, 0xff, 0xff, 0x80, 0x02,
			0x04, 0x00, 0x0e, 0x21, 0x13, 0x09, 0x10, 0x01, 0x01, 0x01, 0x01, 0xff, 0xff, 0xff, 0xff, 0x7f, 0x03,
		},
		expected: []string{
			"10.1.0.3/32",
			"1.1.1.1/32",
		},
	},
}

func TestGetQosRule(t *testing.T) {
	for _, tc := range testQosRuleCases {
		t.Run(tc.name, func(t *testing.T) {
			rules := util.GetQosRule(tc.ruleBytes, nil)
			assert.Equal(t, tc.expected, rules)
		})
	}
}
